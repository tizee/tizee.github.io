{"componentChunkName":"component---src-templates-post-jsx","path":"/post/80d6bf9b412c846fc10914668a066f4c","result":{"data":{"post":{"id":"c08f8f98-fd10-5460-b902-d17d56c6a316","excerpt":"本来是Gist上的Snippet，这里在博客里再备份一下。 问题 我想要通过B来代理A发送给C的git clone请求而不是用 ssh-agent转发 。为什么A不直接向C发起请求呢？通常是出于安全或下载速度上的考虑，对于中文用户而言，一般都是GFW（笑，梯子还是没有ssh…","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Proxy Git in China\",\n  \"date\": \"2020-07-03\",\n  \"category\": \"snippets\",\n  \"tags\": [\"git\"]\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\u672C\\u6765\\u662FGist\\u4E0A\\u7684Snippet\\uFF0C\\u8FD9\\u91CC\\u5728\\u535A\\u5BA2\\u91CC\\u518D\\u5907\\u4EFD\\u4E00\\u4E0B\\u3002\"), mdx(\"h2\", null, \"\\u95EE\\u9898\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"A(\\u672C\\u5730\\u8BA1\\u7B97\\u673A) <-> B(\\u8DF3\\u677F\\u670D\\u52A1\\u5668) <-> C\\uFF08git repo\\u4ED3\\u5E93\\u6240\\u5728\\u670D\\u52A1\\u5668)\\n\")), mdx(\"p\", null, \"\\u6211\\u60F3\\u8981\\u901A\\u8FC7B\\u6765\\u4EE3\\u7406A\\u53D1\\u9001\\u7ED9C\\u7684git clone\\u8BF7\\u6C42\\u800C\\u4E0D\\u662F\\u7528\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://developer.github.com/v3/guides/using-ssh-agent-forwarding/\"\n  }), \"ssh-agent\\u8F6C\\u53D1\"), \"\\u3002\\u4E3A\\u4EC0\\u4E48A\\u4E0D\\u76F4\\u63A5\\u5411C\\u53D1\\u8D77\\u8BF7\\u6C42\\u5462\\uFF1F\\u901A\\u5E38\\u662F\\u51FA\\u4E8E\\u5B89\\u5168\\u6216\\u4E0B\\u8F7D\\u901F\\u5EA6\\u4E0A\\u7684\\u8003\\u8651\\uFF0C\\u5BF9\\u4E8E\\u4E2D\\u6587\\u7528\\u6237\\u800C\\u8A00\\uFF0C\\u4E00\\u822C\\u90FD\\u662FGFW\\uFF08\\u7B11\\uFF0C\\u68AF\\u5B50\\u8FD8\\u662F\\u6CA1\\u6709ssh tunneling\\u88F8\\u5954\\u5FEB\\u3002\"), mdx(\"h2\", null, \"\\u89E3\\u51B3\\u529E\\u6CD5\"), mdx(\"h3\", null, \"\\u6CBF\\u7528\\u6B63\\u5E38\\u7684ssh url\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u8BBE\\u7F6Essh tunnel\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"ssh -ND locahost:9999 [proxy_user]@[proxy_hostname] -p [port]\\n\")), mdx(\"ol\", {\n    \"start\": 2\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u5728.ssh/config\\u8BBE\\u7F6E\\u9700\\u8981\\u901A\\u8FC7ssh tunnel\\u8F6C\\u53D1\\u7684\\u670D\\u52A1\\u5668\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"# .ssh/config\\nHost github.com\\n  User git\\n  IdentityFile ~/.ssh/github_id_rsa\\n  ProxyCommand nc -x localhost:9999 %h %p\\n\")), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"git clone\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"git clone git@github.com:[username]/[reponame].git\\n\")), mdx(\"h3\", null, \"\\u4F7F\\u7528\\u672C\\u5730localhost\\u4F5C\\u4E3A ssh url\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u5728\\u8BBE\\u7F6Essh tunnel\\u65F6\\u5C31\\u8BBE\\u7F6E\\u597D\\u5BF9\\u5E94\\u7684git\\u4ED3\\u5E93\\u670D\\u52A1\\u5668\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"ssh -NL 9999:github.com:22 [proxy_user]@[proxy_hostname]\\n\")), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"git clone\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"git clone ssh://git@localhost:9999/[username]/[reponame].git\\n\")), mdx(\"p\", null, \"\\u8FD9\\u4E2A\\u66F4\\u65B9\\u4FBF\\u4E9B\\uFF08\\u53EA\\u9700\\u8981\\u4E24\\u6761\\u547D\\u4EE4\\uFF0C\\u61D2\\u4EBA\\u798F\\u97F3\\uFF09\\u3002\"), mdx(\"h2\", null, \"Question\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"A(local machine) <-> B(proxy server) <-> C(git repo server)\\n\")), mdx(\"p\", null, \"I would like to git clone the repo on local machine \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"A\"), \" instead of \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://developer.github.com/v3/guides/using-ssh-agent-forwarding/\"\n  }), \"ssh-agent forwarding\"), \" that clones the repo on\\nproxy server B. Why not clone the repo directly on A? Well, for the sake of security or the network latency\\uFF08download speed). For Chinese users, this is mainly due to GFW.\"), mdx(\"h2\", null, \"Solution\"), mdx(\"h3\", null, \"clone with normal ssh url\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"setup a tunnel between localhost port and proxy server\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"ssh -ND locahost:9999 [name]@[hostname] -p [port]\\n\")), mdx(\"ol\", {\n    \"start\": 2\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"setup .ssh/config\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"# .ssh/config\\nHost github.com\\n  User git\\n  IdentityFile ~/.ssh/github_id_rsa\\n  ProxyCommand nc -x localhost:9999 %h %p\\n\")), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"git clone\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"git clone git@github.com:[username]/[reponame].git\\n\")), mdx(\"p\", null, \"Here we only proxy commands to github.com.\"), mdx(\"h3\", null, \"clone with localhost ssh url\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"setup a tunnel between localhost port and proxy server that only forward conections to github.com:22\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"ssh -NL 9999:github.com:22 [proxy_user]@[proxy_hostname]\\n\")), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"git clone\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"git clone ssh://git@localhost:9999/[username]/[reponame].git\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","fields":{"date":"2020-07-03","title":"Proxy Git in China","category":"snippets","tags":["git"],"slug":"80d6bf9b412c846fc10914668a066f4c"},"timeToRead":1,"tableOfContents":{"items":[{"url":"#问题","title":"问题"},{"url":"#解决办法","title":"解决办法","items":[{"url":"#沿用正常的ssh-url","title":"沿用正常的ssh url"},{"url":"#使用本地localhost作为-ssh-url","title":"使用本地localhost作为 ssh url"}]},{"url":"#question","title":"Question"},{"url":"#solution","title":"Solution","items":[{"url":"#clone-with-normal-ssh-url","title":"clone with normal ssh url"},{"url":"#clone-with-localhost-ssh-url","title":"clone with localhost ssh url"}]}]}}},"pageContext":{"id":"c08f8f98-fd10-5460-b902-d17d56c6a316","previous":{"post":{"id":"794a993b-6aca-5985-bf61-afe919845d18","parent":{"id":"2d4559ee-9619-5ae0-90d4-af99ae8d36a3"},"excerpt":"主要工具 使用 chmod 变更文件读写执行(RWX)的权限，若不为文件所有者，则需要ROOT权限。 Absolute mode 使用 octal number 文件权限用3位数字表示，分别对应owner,group,others。 读为4，写为2，执行为…","slug":"c997ef063bd957985042ae24079e4509","title":"文件权限管理","tags":["linux"],"category":"bash","date":"2020-07-01"}},"next":{"post":{"id":"7318b655-83b1-5e3a-b0a0-5ab435d933d3","parent":{"id":"4d1a506b-13e3-589e-8fa5-93c2364efc78"},"excerpt":"Problem yarn add imagemin-mozjpeg  failed due to missing some system level dependencies. Solution Install following dependencies: As macOS…","slug":"83f60ba72853f6555a99cf05c0553e64","title":"Install Mozjpeg","tags":["linux","macos"],"category":"snippets","date":"2020-07-05"}}}}}